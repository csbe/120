package ch.csbe.rechner;

import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.scene.control.Label;
import javafx.scene.input.MouseEvent;

public class CalcController {

	@FXML protected Label output;
	@FXML protected Label calc;
	private String result = "";
	private String outputtext = "";
	
	@FXML protected void calc(MouseEvent event) throws ScriptException{
		Label l = (Label) event.getSource();
		
		switch(l.getText()){
		case "C": calc.setText("");
		case "CE": output.setText(""); result=""; outputtext=""; break;
		case "=": 
			result += outputtext + ";";
			System.out.println(result);
			ScriptEngine engine =
            new ScriptEngineManager().getEngineByName("JavaScript");
			outputtext = engine.eval(result).toString();
			calc.setText(""); output.setText(outputtext); 
			result=""; break;
		case "Â±": 
			outputtext = "-" + outputtext;
			output.setText(outputtext);	
			break; 
		case ":": ; 
		case "*": ; 
		case "-": ; 
		case "+": 
			result += outputtext + " " + l.getText() + " ";
			outputtext = "";
			calc.setText(result);			
		; break;
		default: 
			outputtext += l.getText();
			output.setText(outputtext);
			break;
		}
		
		initialize();
		
	}
	
	@FXML protected void initialize(){
		if(outputtext.length() == 0){
			outputtext = "0";
		}
	}
	
}
